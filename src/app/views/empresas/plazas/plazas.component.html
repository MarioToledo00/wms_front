<div class="d-flex justify-content-between allign-items-center">
    <div>
      <h1>Plazas</h1>
      <p>Lista de plazas</p>
    </div>
    <div class="align-content-center">
        <button   color="primary" disabled="false" (click)="mostrarModal()" cButton>Agregar</button>
      </div>
  </div>  
  
  <div class="table-overflow-x" >
   
    <table striped="true" cTable>
        <thead>
        <tr>
            
            <th scope="col">Plaza</th>
            <th scope="col">Empresa</th>
            <th scope="col">Editar</th>
        </tr>
        </thead>
        @if(!Loading){
          
          <tbody>
            
              @for (record of plazas; track record.id) {
                  <tr>
                      <td>{{record.nombre}}</td>
                      <td>{{record.empresa}}</td>
                      <td><button class="btn"style="color: white;"  color="primary" cButton (click)="mostrarModal(true,record.id)"><img src="assets/svg/pencil.svg" alt="pencil" ></button></td>          
                  </tr>
              }   
            
          </tbody>
        
        }
      </table>
    
      @if(Loading){
        
          <c-spinner style="align-self: center;"  color="primary"></c-spinner>

        
      }

      @if(!Loading && !plazas.length){
        
        <h3 style="align-self: center;" >No hay datos para mostrar</h3>
      
      }
</div>
     


        
<c-modal alignment="center" [visible]="modalRegistro" backdrop="static">
    <c-modal-header><b>{{TituloModal}}</b></c-modal-header>
    <c-modal-body>
      <form cForm [formGroup]="aplyForm" 
              #customStylesForm="ngForm"
                  [validated]="customStylesValidated"
                  cForm
                  class="row g-3 needs-validation">
                <p class="text-body-secondary">{{SubTituloModal}}</p>

                <c-input-group class="mb-3">
                  <span cInputGroupText>
                    <svg cIcon name="cilUser"></svg>
                  </span>
                  <input  autoComplete="nombrePlaza" cFormControl formControlName="nombrePlaza" placeholder="Plaza" required="true" [class.border-danger]="inValidPlaza" />
                </c-input-group>
                
                <c-input-group class="mb-3">
                    <span cInputGroupText>
                      <svg cIcon name="cilLocationPin"></svg>
                    </span>
                    <select formControlName="empresa_id"  aria-label="Default select example" [class.border-danger]="inValidEmpresa"  cSelect> 
                      <option value="" disabled selected>Empresa...</option>
                      <option *ngFor="let empresa of empresas" [value]="empresa.id" [style.cursor]="'pointer'">
                        {{ empresa.razon_social }}
                      </option>
                    </select>
                </c-input-group>
  
              </form>
    </c-modal-body>
    <c-modal-footer>
      <div>
        @if(editPlaza.edit){
          <button color="light" class="btn color-danger"  type="submit" (click)="this.alertDelete=true; this.modalRegistro =false;"  [disabled]="Loading">@if (Loading){<c-spinner aria-hidden="true" size="sm"></c-spinner>}Eliminar</button>
        }
      </div>
      <div>
        <button class="btn btn-secondary" (click)="this.modalRegistro = false">Cancelar</button>
        <button class="btn btn-success" style="color: white;"  type="submit" (click)="onSubmitRegister()" [disabled]="Loading">@if (Loading){<c-spinner aria-hidden="true" size="sm"></c-spinner>}Guardar</button>
      </div>
    </c-modal-footer>
  
  
  
  </c-modal>



  <c-modal [visible]="alertDelete" alignment="center"  backdrop="static" >
    <c-modal-header><b>Confirmación</b></c-modal-header>
    <c-modal-body>
      ¿Estás seguro de que deseas eliminar esta plaza?
    </c-modal-body>
    <c-modal-footer>
      <div></div>
      <div>
        <button 
        color="secondary"
        cButton
        variant="outline"class="btn btn-secondary" (click)="this.alertDelete=false" [disabled]="Loading">Cancelar</button>
        <button class="btn btn-danger"style="color: white;" (click)="deletePlaza()" [disabled]="Loading">@if (Loading){<c-spinner aria-hidden="true" size="sm"></c-spinner>}Eliminar</button>
      </div>
    </c-modal-footer>
  </c-modal>

 
  


  <c-container class="floating-alert-container">
    <c-alert [(visible)]="inValidRequest" dismissible color="danger" fade class="alert">
        <strong>Error: </strong> {{RequestMessage}}.
    </c-alert>
    <c-alert [(visible)]="successRequest" dismissible color="success" fade class="alert">
        <strong>Éxito</strong> {{RequestMessage}}.
    </c-alert>
    <c-alert [(visible)]="warningRequest" dismissible color="warning" fade class="alert">
        <strong>Atención</strong> {{RequestMessage}}.
    </c-alert>
</c-container>